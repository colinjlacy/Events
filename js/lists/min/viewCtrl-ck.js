angular.module("boomCal").controller("viewCtrl",function(e,t,i,s,n){var o=function(i){t({url:"server/retrieve_list_items.php",method:"GET",params:{list_id:i}}).success(function(t){console.log(t),e.items=t}).error(function(t){e.viewError=t})};o(i.id),e.doneToggle=function(e){e.done=1==e.done?0:1},e.hideDoneToggle=function(){e.hideDone?(e.hideDone=!1,document.getElementById("hide-toggle").innerHTML="Hide Checked"):(e.hideDone=!0,document.getElementById("hide-toggle").innerHTML="Show Checked")},e.shouldBeHidden=function(t){return e.hideDone&&1==t.done?!0:void 0},e.updateList=function(){var i=[];console.log(e.items);for(var s=0;s<e.items.length;s++)console.log(e.items[s].id+" = "+e.items[s].done),1==e.items[s].done&&(i.push(e.items[s].id),e.items.splice(s,1),s-=1);console.log(i),t({url:"delete_items.php",method:"POST",data:i}).success(function(e){console.log(e),n.path("/")})},e.deleteList=function(e){var i="server/delete_list.php";t({url:i,method:"POST",data:{list_id:e,google_id:s.google_id}}).success(function(e){n.path("lists/")})},e.editList=function(e){n.path("lists/edit/"+e)},e.addItem=function(t){e.items.push(t),e.itemToAdd="";var i=document.getElementById("addInput");i.focus()},e.remove=function(t){e.items.splice(t,1)},e.saveEditedList=function(){var i="server/edit_list.php",o={google_id:s.google_id,list_id:s.activeList.id,items:e.items};t({url:i,method:"POST",data:o}).success(function(e){n.path("lists/"+e),s.activeList.alert={type:"alert-success",message:"This list has been updated!  Nicely done!"}})},e.showCalendarForm=function(){e.calendarForm=!0},e.showEmailForm=function(){e.emailForm=!0},e.showShareForm=function(){e.shareForm=!0},e.addToCalAttendees=function(){e.listAttendees&&e.listAttendees.length>0||(e.listAttendees=[]),e.listAttendees.push(e.attendee),e.attendee=void 0},e.addToRecipients=function(){e.listRecipients&&e.listRecipients.length>0||(e.listRecipients=[]),e.listRecipients.push(e.recipient),e.recipient=void 0},e.addToShare=function(){e.listShare&&e.listShare.length>0||(e.listShare=[]),e.listShare.push(e.recipient.email),e.recipient=void 0},e.shareList=function(){var n={list_id:i.id,message:e.shareMessage,listShare:e.listShare,creator_id:s.data.user.id,creator_display:s.data.user.displayName};t({url:"server/share_list.php",method:"POST",data:n}).success(function(e){console.log("it worked! "+e)})},e.addToCalendar=function(){for(var i=e.token,o,a=0;a<e.items.length;a++)o+="<li>"+e.items[a].name+"</li>";var l=e.listMessage+" <ul>"+o+"</ul><a href='"+n.absUrl()+"'>View it online!</a>",d=[];if(e.listAttendees)for(var a=0;a<e.listAttendees.length;a++)d.push({email:e.listAttendees[a].email});var r=encodeURIComponent(e.listCalendar.id),c={start:{date:e.listDate.toISOString().slice(0,10)},end:{date:e.listDate.toISOString().slice(0,10)},summary:s.activeList.title,description:l,attendees:d};t({url:"https://www.googleapis.com/calendar/v3/calendars/"+r+"/events?sendNotifications=true&key=185024779579-go9t2i4b44oaffv6as49ijotubekkcql.apps.googleusercontent.com&access_token="+i,method:"POST",data:c}).success(function(){e.calendarForm=!1,s.activeList.alert={type:"alert-success",message:"This list has been added to your calendar!  Nicely done!"}}).error(function(e){s.activeList.alert={type:"alert-danger",message:"There was an error: "+e}})},e.sendEmail=function(){t({url:"server/send_mail.php",method:"POST",data:{recipients:e.listRecipients,message:e.listMessage,items:e.items,subject:s.activeList.title}}).success(function(t){console.log(t),e.emailForm=!1,s.activeList.alert={type:"alert-success",message:"This list has been emailed!  Nicely done!"}})},e.viewReset=function(){e.calendarForm=!1,e.emailForm=!1}});